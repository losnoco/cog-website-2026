---
interface CogFeed {
  Title: string;
  PubDate: string; // fmt like Sun, 08 Feb 2026 19:25:48 -0800
  Version: string;
  ShortVersionString: string;
  Description: string;
  MinimumSystemVersion: string;
  Enclosure: Enclosure;
  ReleaseNotesLink: string;
}

interface Enclosure {
  URL: string;
  Length: string;
  Type: string;
  EdSignature: string;
}

interface CogFeedFmtd extends CogFeed {
  size: string;
  date: string;
}

import { filesize } from "filesize";
import { DateTime } from "luxon";

import "../styles.scss";

const feed = await fetch("https://cogcdn.cog.losno.co/mercury.json").then((r) =>
  r.json(),
);

const feedFmtd: CogFeedFmtd[] = feed.map((item: CogFeed) => {
  return {
    ...item,
    size: filesize(parseInt(item.Enclosure.Length)),
    date: DateTime.fromRFC2822(item.PubDate).toLocaleString(
      DateTime.DATETIME_MED,
    ),
  };
});
const [latest, ...older] = feedFmtd;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />
    <title>Cog — Audio Player for macOS</title>
    <meta
      name="description"
      content="A free and open source audio player for macOS."
    />
    <meta property="og:url" content={Astro.site} />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Cog" />
    <meta
      property="og:description"
      content="A free and open source audio player for macOS."
    />
    <meta property="og:image" content={Astro.site + "hero.png"} />
    <meta name="twitter:card" content="summary_large_image" />
    <meta property="twitter:domain" content="cog.losno.co" />
    <meta property="twitter:url" content={Astro.site} />
    <meta name="twitter:title" content="Cog" />
    <meta
      name="twitter:description"
      content="A free and open source audio player for macOS."
    />
    <meta name="twitter:image" content={Astro.site + "hero.png"} />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  </head>
  <body>
    <header class="sticky-top">
      <div class="container py-2">
        <div class="d-flex align-items-center gap-3">
          <a class="nav-brand" href="/">
            <img src="/favicon-32x32.png" alt="Cog" width="24" height="24" />
            Cog
          </a>

          <div class="d-flex align-items-center gap-3 ms-auto">
            <a class="nav-link-upper" href="#features">Features</a>
            <a class="nav-link-upper" href="#formats">Formats</a>
            <a class="nav-link-upper" href="#older">Versions</a>
            <a class="nav-link-upper" href="https://github.com/losnoco/cog" target="_blank">GitHub</a>
            <a class="nav-link-upper" href="https://discord.gg/4A6mrhtfAz" target="_blank">Discord</a>

            <div class="dropdown">
              <button
                class="btn btn-sm btn-donate dropdown-toggle"
                type="button"
                data-bs-toggle="dropdown"
                aria-expanded="false">Donate</button>
              <ul class="dropdown-menu dropdown-menu-end">
                <li><a class="dropdown-item" href="https://paypal.me/kode54" target="_blank">PayPal</a></li>
                <li><a class="dropdown-item" href="https://patreon.com/kode54" target="_blank">Patreon</a></li>
                <li><a class="dropdown-item" href="https://ko-fi.com/kode54" target="_blank">Ko-fi</a></li>
                <li><a class="dropdown-item" href="https://liberapay.com/kode54" target="_blank">LiberaPay</a></li>
                <li><a class="dropdown-item" href="https://github.com/sponsors/kode54" target="_blank">GitHub Sponsors</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </header>

    <div class="container py-4">
      <!-- Hero -->
      <div class="jumbotron rounded-3 p-4 mb-5">
        <div class="sec-label">Audio Player for macOS</div>
        <h2 class="hero-title pb-3">A free and open source audio player for macOS.</h2>

        <div class="d-flex flex-wrap align-items-center gap-3 mb-3">
          <a class="btn btn-download btn-lg" href={latest.Enclosure.URL}>
            Download v{latest.Version}
            <span class="size-label">{latest.size}</span>
          </a>
          <a href="https://apps.apple.com/us/app/cog-kode54/id1630499622">
            <img src="/masdl.svg" alt="Download on the Mac App Store" style="height: 40px;" />
          </a>
        </div>

        <div class="hero-meta mb-3">
          Published {latest.date} · Requires macOS {latest.MinimumSystemVersion}
        </div>

        <div class="hero-notes" set:html={latest.Description} />

        <div class="mt-3">
          <a class="btn btn-sm btn-outline-losnoco" href="#older">Older versions ↓</a>
        </div>
      </div>

      <!-- Features -->
      <section id="features" class="py-5">
        <div class="sec-label">Features</div>
        <h2>What Cog does</h2>
        <ul class="feature-list">
          <li>Gapless playback</li>
          <li>Automatic updates</li>
          <li>Global hotkeys</li>
          <li>Desktop notifications</li>
          <li>Shuffle, both albums and tracks</li>
          <li>Repeat single track, album, or whole playlist</li>
          <li>
            Playback from HTTP(S) sources, both livestreams and static files
            <ul>
              <li>Apple's HTTP Live Streaming (HLS) via FFmpeg</li>
              <li>Live metadata from Shoutcast, Icecast, Ogg Vorbis comments, and timed ID3v2 packets</li>
            </ul>
          </li>
          <li>CUE Sheet support, including embedded CUE Sheets in several formats</li>
          <li>Album artwork per track — embedded and external, cached per unique image. JPEG, PNG, GIF, WebP, HEIC, or AVIF.</li>
          <li>Graphic equalizer</li>
          <li>Spectrum visualization in the toolbar</li>
          <li>
            HRTF for binaural sound
            <ul>
              <li>Head tracking with AirPods and compatible headphones (macOS Monterey+)</li>
            </ul>
          </li>
          <li>Speed control and pitch shifting via the <a href="https://breakfastquay.com/rubberband/">Rubber Band library</a></li>
        </ul>
      </section>

      <!-- Formats -->
      <section id="formats" class="py-5">
        <div class="sec-label">Supported Formats</div>
        <h2>Plays almost anything</h2>
        <div class="formats-grid">
          <div class="formats-col">
            <ul>
              <li>MP3 (including free format, up to 640kbps; via <a href="https://github.com/lieff/minimp3">minimp3</a>)</li>
              <li>WAV</li>
              <li>MPEG-4 container, including chapter support</li>
              <li>Matroska container, including chapter support</li>
              <li>
                AAC
                <ul>
                  <li>LC-AAC</li>
                  <li>HE-AAC</li>
                  <li>HE-AACv2</li>
                  <li>xHE-AAC (USAC)</li>
                </ul>
              </li>
              <li>Apple Lossless (ALAC)</li>
              <li>FLAC (including OggFLAC)</li>
              <li>Ogg Opus</li>
              <li>Ogg Vorbis</li>
              <li>AC3</li>
              <li>Windows Media Audio</li>
              <li>DTS</li>
              <li>TrueHD</li>
              <li>HDCD</li>
              <li>TTA True Audio</li>
              <li>TAK (Tom's Lossless Audio Kompressor)</li>
              <li>Monkey's Audio (APE)</li>
              <li>APL (APE Linking File)</li>
              <li>TwinVQ</li>
              <li>RealAudio</li>
              <li>ATRAC3</li>
              <li>Musepack</li>
              <li>WavPack, including DSD support</li>
              <li>Interchange File Format (IFF) including DSDIFF</li>
              <li>DSD Stream File (DFF)</li>
              <li>Wideband Single-bit Data (WSD)</li>
            </ul>
          </div>
          <div class="formats-col">
            <ul>
              <li>
                MIDI
                <ul>
                  <li>SoundFont support via <a href="http://www.un4seen.com/bass.html">BASSMIDI</a></li>
                  <li>FM synthesis via <a href="https://nukeykt.retrohost.net/">Nuked OPL3</a></li>
                  <li>Sound Canvas emulation via <a href="https://github.com/nukeykt/Nuked-SC55">Nuked SC55</a></li>
                  <li>Audio Unit synthesizer support, including Apple's DLSMusicDevice</li>
                </ul>
              </li>
              <li>Shorten</li>
              <li>
                Tracker music
                <ul>
                  <li><a href="https://lib.openmpt.org/libopenmpt/">libopenmpt</a> (<a href="https://openmpt.org/features#modules">full list of supported formats</a>)</li>
                  <li>AHX/HVL (Hively Tracker)</li>
                  <li>Syntrax/Jaytrax</li>
                </ul>
              </li>
              <li>SID</li>
              <li>
                Game music
                <ul>
                  <li>GBS (Game Boy)</li>
                  <li>NSF (Nintendo)</li>
                  <li>SPC and SNSF (Super Nintendo)</li>
                  <li>VGM (Master System, Genesis/Mega Drive, Game Gear, etc)</li>
                  <li>VGZ (compressed variant of the above)</li>
                  <li>PSF (PlayStation)</li>
                  <li>SSF (Saturn)</li>
                  <li>DSF (Dreamcast)</li>
                  <li>QSF (Q-Sound)</li>
                  <li>USF (Nintendo 64)</li>
                  <li>NCSF and 2SF (Nintendo DS)</li>
                  <li>Organya (Cave Story)</li>
                  <li>Streamed music via <a href="https://vgmstream.org">vgmstream</a></li>
                </ul>
              </li>
              <li>
                Archive files
                <ul>
                  <li>ZIP</li>
                  <li>RAR</li>
                  <li>GZip</li>
                  <li>7Z</li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Older Versions -->
      <section id="older" class="py-5">
        <div class="sec-label">Archive</div>
        <h2>Older versions</h2>
        {
          older.map((item: CogFeedFmtd) => (
            <div class="version-entry" id={"v" + item.Version}>
              <div class="d-flex align-items-baseline flex-wrap gap-2 mb-2">
                <span class="version-num">v{item.Version}</span>
                <span class="version-date">{item.date}</span>
                <a class="btn btn-sm btn-outline-losnoco ms-auto" href={item.Enclosure.URL}>
                  Download <span class="size-label">{item.size}</span>
                </a>
              </div>
              <div class="version-notes" set:html={item.Description} />
            </div>
          ))
        }
      </section>

      <!-- Legacy -->
      <section id="oldest" class="py-5">
        <div class="sec-label">Legacy</div>
        <h2>Very old builds</h2>
        <div class="legacy-grid">
          <a class="legacy-card" href="https://cogcdn.cog.losno.co/Cog-3b628c398.zip">
            <div class="legacy-ver">Version 1148</div>
            <div class="legacy-os">Mountain Lion</div>
          </a>
          <a class="legacy-card" href="https://cogcdn.cog.losno.co/Cog-ff44bc4d.zip">
            <div class="legacy-ver">Version 2405</div>
            <div class="legacy-os">Sierra</div>
          </a>
          <a class="legacy-card" href="https://cogcdn.cog.losno.co/Cog-e0a358efb.zip">
            <div class="legacy-ver">Version 3349</div>
            <div class="legacy-os">High Sierra</div>
          </a>
        </div>
      </section>

      <!-- Footer -->
      <footer class="site-footer pt-4 d-flex align-items-center justify-content-between flex-wrap gap-3">
        <div>
          &copy; 2021–2026 <a href="https://kode54.net">Christopher Snowhill</a>.
          <a href="https://cogx.org/">Originally developed</a> by <a href="http://vspader.com/">Vincent Spader</a>.
        </div>
        <div class="d-flex align-items-center gap-3">
          <a href="https://losno.co">
            <img
              src="https://assets.losno.co/WordmarkForLight.svg"
              alt="LoSnoCo"
              style="height: 14px;"
            />
          </a>
          <a href="https://astro.build">
            <img
              src="https://astro.badg.es/v2/built-with-astro/tiny.svg"
              alt="Built with Astro"
              width="120"
              height="20"
            />
          </a>
        </div>
      </footer>
    </div>
  </body>
  <script>
    import { Dropdown } from "bootstrap";

    (() => {
      "use strict";

      const storedTheme = localStorage.getItem("theme");

      const getPreferredTheme = () => {
        if (storedTheme) {
          return storedTheme;
        }

        return window.matchMedia("(prefers-color-scheme: dark)").matches
          ? "dark"
          : "light";
      };

      const setTheme = function (theme: string) {
        if (
          theme === "auto" &&
          window.matchMedia("(prefers-color-scheme: dark)").matches
        ) {
          document.documentElement.setAttribute("data-bs-theme", "dark");
        } else {
          document.documentElement.setAttribute("data-bs-theme", theme);
        }
      };

      setTheme(getPreferredTheme());

      window
        .matchMedia("(prefers-color-scheme: dark)")
        .addEventListener("change", () => {
          if (storedTheme !== "light" && storedTheme !== "dark") {
            setTheme(getPreferredTheme());
          }
        });

      window.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll("[data-bs-theme-value]").forEach((toggle) => {
          toggle.addEventListener("click", () => {
            const theme = toggle.getAttribute("data-bs-theme-value");
            if (theme) {
              localStorage.setItem("theme", theme);
              setTheme(theme);
            }
          });
        });
      });
    })();
  </script>
</html>
